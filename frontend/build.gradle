plugins {
    id "com.github.node-gradle.node" version "3.0.1"
}

node {
    download = true
    version = "14.15.4"
    npmVersion = "7.5.4"
    yarnVersion = "1.22.10"
}

task clean(type: Delete) {
    doLast {
        ['dist', 'node', '.gradle', 'build', 'node_modules'].forEach {
            delete it
        }
    }
}

task build(type: YarnTask) {
    dependsOn 'nodeSetup'
    dependsOn 'yarn'

    outputs.dir('build')

    args = ['build']
}

task copy(type: Copy){
    dependsOn 'build'

    outputs.dir(project.rootDir.path + '/src/main/resources/static')
    inputs.dir('build')

    from('build')
    into(project.rootDir.path + '/src/main/resources/static')
}
